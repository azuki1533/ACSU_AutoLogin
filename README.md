# ACSU_AutoLogin

信州大学のACSU認証が必要なサイトに自動でログインするためのuserscriptです。アカウントが複数ある場合にも対応しています。

## 概要

このUserscriptは、信州大学のACSU認証システムにおける一連のログインプロセスを自動化します。以下の3つのステップに対応しており、ログインにかかる手間を大幅に削減します。

1.  **ID・パスワードによるログイン**
2.  **イメージマトリックスによる多要素認証**
3.  途中で表示されることがある**Microsoft認証画面**

アカウントが1つの場合は完全に自動でログイン処理が進み、複数のアカウントを使い分けている場合は、ステップ1.の画面で選択UIが表示され、その後の多要素認証は自動的に実行されます。

## 主な機能

-   **IDとパスワードの自動入力・送信**: ログインページにアクセスすると、設定された情報で自動的にログインします。
-   **多要素パスワードの自動入力**: 2段階認証ページで、事前に設定した順番に基づきアルファベットを自動で順番に入力・送信します。
-   **Microsoft認証の自動通過**: Microsoftの認証画面が表示された場合、「続行」ボタンを自動でクリックします。
-   **複数アカウント対応**:
    -   アカウントが1つの場合は、選択UIを表示せず完全に自動でログインします。
    -   アカウントが2つ以上ある場合は、画面上部にアカウント選択ボタンを表示します。

## 必要なもの

### PC

-   PC用のウェブブラウザ（Google Chrome, Firefox, Microsoft Edgeなど）
-   Userscriptマネージャー（以下のいずれかのブラウザ拡張機能）
    -   [**Tampermonkey**](https://www.tampermonkey.net/) (推奨)
    -   [Violentmonkey](https://violentmonkey.github.io/)

### iPhone/iPad

-   Safari 
-   Userscriptマネージャー (以下のいずれかをApp Storeからインストール)
    -   [**Userscripts**](https://apps.apple.com/jp/app/userscripts/id1463298887) (無料)
    -   [Tampermonky](https://apps.apple.com/jp/app/tampermonkey/id6738342400) (有料)

### Android

-   拡張機能が使用できるブラウザ (Microsoft Edge Canary, Firefoxなど)
-   Userscriptマネージャー
    -   [**Tampermonky**](https://www.tampermonkey.net/)

## インストール&設定方法

### PC

1.  お使いのブラウザに**Tampermonkey**などのUserscriptマネージャーをインストールします。
2.  Tampermonkeyの管理画面を開き、「新規スクリプトを追加」タブ（`+`のアイコン）をクリックします。
3.  表示されたエディタ画面に、[自動ログイン & 2段階認証 (信州大学) - 統合版](https://github.com/azuki1533/ACSU_AutoLogin/blob/main/%E8%87%AA%E5%8B%95%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%20%26%202%E6%AE%B5%E9%9A%8E%E8%AA%8D%E8%A8%BC%20(%E4%BF%A1%E5%B7%9E%E5%A4%A7%E5%AD%A6)%20-%20%E7%B5%B1%E5%90%88%E7%89%88.user.js)の内容をすべてコピー＆ペーストします。
4.  コードの冒頭にある `// --- 設定: ここに自分のアカウント情報をすべて入力してください ---` のセクションを探します。
5.  `const accounts = [...]` の部分を、ご自身の情報に合わせて編集します。複数のアカウントがある場合には、すべてのアカウント情報を記載します。詳しい記載方法は下記の設定例や上記コード内を参照してください。
6.  これでインストール&設定は完了です。

### iPhone/iPad

1.  App StoreからUserscriptマネージャーをインストールする。基本的に無料の[Userscripts](https://apps.apple.com/jp/app/userscripts/id1463298887)のほうで大丈夫です。
2.  インストールが終わったらアプリを開き、案内に従って設定 -> Safari -> 機能拡張 -> Userscriptsに進み、`機能拡張を許可`のトグルをオンにする。そして、その下の`アクセス権`を許可に変更します。
3.  PCのTampermonkeyの管理画面で、アカウント情報を設定したスクリプトの`ファイル`から`ディスクに保存`をクリックしてダウンロードします。
4.  ダウンロードしたファイルをiPhoneに送り、Userscriptsアプリが参照しているディレクトリに保存します。
5.  以上でインストール&設定は完了です。

※iPhone/iPad単体でもスクリプトをGitHubからダウンロードし、Documentsアプリなどでアカウント情報を編集して保存すれば利用可能ですが、PCで設定するほうが簡単です。

### Android

1.  ブラウザを起動して拡張機能のインストールを有効にします。これはブラウザによって手順が異なるので詳細は調べてください。
2.  **Tampermonkey**などのUserscriptマネージャーをインストールします。
3.  以降はPCと同じ手順です。

---

### 設定例：アカウントが1つの場合

UIは表示されず、この情報で完全に自動ログインします。

```javascript
const accounts = [
    {
        name: '学生アカウント',                        // 任意のアカウント名
        username: 's23t001',                          // 学籍番号など
        password: 'your_password',                    // ログインパスワード
        matrixOrder: ["A", "B", "C", "D"]             // イメージマトリックスの順番
    },
];
```

---

### 設定例：アカウントが2つ以上の場合

ログイン時と（必要に応じて）多要素認証時に、アカウント選択UIが画面上部に表示されます。

```javascript
const accounts = [
    {
        name: '学部アカウント',
        username: 's23t001',
        password: 'your_password_1',
        matrixOrder: ["A", "B", "C", "D"]
    },
    {
        name: '大学院アカウント',
        username: 'g23x999',
        password: 'your_password_2',
        matrixOrder: ["E", "F", "G", "H"]
    },
];
```

**【重要】**
-   `username`, `password`, `matrixOrder` は必ずご自身の正しい情報に書き換えてください。
-   編集が終わったら、必ずファイルを**保存**してください。

## 使い方

インストールと設定が完了したら、あとは通常通り [ACSUのログインページ](https://acsu.shinshu-u.ac.jp/) にアクセスするだけです。

-   **単一アカウントの場合**: ページ遷移を含め、すべての処理が自動的に実行されます。
-   **複数アカウントの場合**: 画面上部に表示されるアカウント選択ボタン（例: `[学部アカウント]`, `[大学院アカウント]`）をクリックしてください。その後の2段階認証は自動で処理されます。

## ⚠️ 注意事項

-   **このスクリプトは、利便性のためにパスワード等の認証情報をコード内に直接記述します。お使いのPCやスマホの管理には十分ご注意ください。本スクリプトの使用は、自己責任でお願いします。**
-   大学側のウェブサイトの仕様が変更された場合、スクリプトが正常に動作しなくなる可能性があります。
-   本スクリプトは研究目的で作成されたものであり、動作を恒久的に保証するものではありません。

## ライセンス

[GPL-3.0 license](https://github.com/azuki1533/ACSU_AutoLogin/blob/main/LICENSE)
